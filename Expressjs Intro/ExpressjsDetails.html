<html>
    <head>
        <title>

        </title>
    </head>
    <body>
        <pre>
            <code>

              **  package-lock-json ==> older versions unte vatini maintain chestadi eh version app ki emundi ani 

              **  package.json ==> current /latest thing edaithe undo daniki sambandinichina details ani package.json lo untadi 
                        Advantages of package.json ==>
                                   1. maintain the versions [eh versions ni install chesamo] (anni dependencies info untai )
                                   2. scripts kooda run chesukovochu aa extensions kooda manam package.json lo pettukuntam 

              **  server.js ==>
                               mana application run cheyaniki manaki oka server oka port kavali alagae application ni kooda create chesukovali 
                               [ express ki oka app create chesukoni aa app ni 4500/5600/8080 ] only use 4000 series and 8000 series unna port meda 
                               run cheyali. 

                               router antam vettini ila raste ela ante app.get('/', function(){}) ==> ante / isthe aa function execute aithadi
                               aa call back function ki req and res object lu express js create chesi isthai [express req, res modify chesi isthadi ante req ragane marchi manaki req isthadi ]
                               req pampisthe req lo ki velthadi ade res ni ivvali ante res lo untai 
                               ee expressjs vala mana if else lu rayakunda respective path ni req lo tesukoni daniki respective call back function trigger ayy response isthundi
                              [particular path eh router ki match aithado choosi aa function ni trigger aithadi ]

                                app.get('/', function(req, res){

                                        res.send('hello world')
                                 })

                                 app.get('/add/:fn/:ln', function(req, res){

                                    var num1 = + req.params.fn 
                                    var num2 = + req.params.ln
                                    var addNumbers = num1 + num2 
                                    res.send(addNumbers.toString())
                                
                                })
                                
                                
                                app.get('/studentshome' , function(req, res)
                                {
                                       res.sendFile(__dirname+'/students.html') // ikkada __dirname enduku ante current directory lo unnam ga andhuke
                                })


                    ABOUT PUG : 
                    ---------- 

                             PUG is a high performance template engine heavily influenced by HTML and implemented with 
                             Javascript for Node.js and browsers. 

                             Pug is a clean, whitespace sensitive syntax for writing html 

                             To install Pug the command is npm i pug 
                             views ane folder lo home.pug ane file ni create chesukovali 
                             home.pug lo html code rasukovali

                             tarvatha mana server.js lo 
                                   app.set('view engine', 'pug')
                             
                             app.get('/', function(req, res){
                                res.render('home')
                              })

                            manam aa home.pug ki data pampochu 

                            app.get('/', function(req, res){
                                res.render('home' {students : ['mutyam', 'Bhargav' 'Reddy']})
                              }) 

                    pug lo ela rastam code manam ==> 

                         html 
                           head 
                             title  Mutyam 
                               body 
                                 h1 Welcome hero 


                    Middlewares  ==> Madyalo oka function ni execute avvatame middleware

                    bodyParser anedi oka middleware adi em chestadi ante 
                    vachina request lo nunchi payload lo unna data ni pickup chesi 
                    req.body ane property loki insert chesindi 

                    ila middlewares chala untai 

                    server side rendering ==> server side UI generations 
                    UI generation kosam maro application ni rasukuntam kani direct ga Ui application ki backend direct ga connect avvadu 
                    so backend avasaram undi database nunchi data ni techukoniki manaki backend application oka server meda run avvali 
                    

                    Cors origin request specifications 

                    Frontend server oka server+port meda run aithadi ex: 3000 port meda frontend server run aithundi 
                    Backend server oka port meda run aithundi anuko  ex : 4500 port meda run aithundi

                    |-------------------|                                   
                    |  frontend         |
                    |  server  => 3000  |   
                    |-------------------|
                          ||
                          ||
                          ||
                          ||
                          ||
                          \/
                    
                    |-------------------|
                    |  Backend          |
                    |  server  => 4500  |    vere server nunchi backend server ki request vaste backend server evadra nuvvu nuvvu naa server eh kadhu ani antadi     
                    |-------------------|    vatine cors errors ani antam 
                                             ade same server nunchi request vaste em avvadu 


                    
                       server side rendering ante ==> server side ui generation ani ardam 
                       ani server side jaruguthai 
                       Reactjs vadetapudu ante frontend lo ui generation jaruguthundi kabbati backend nunchi only manaki data vastadi 
                       appudu backend pani endi raa ante only database nunchi data ni tevatame dani pani vatine webapi's antaru.

                  Vere or eh server nunchi kooda request ravali accept cheyali mana server ante we need to install cors module/package



                  Middleware ni ela rasukuntam ante  
                      app.use((req, res)=>{

                      })
                    ee middleware execute chesina tarvathane next routes execute aithai 
                    ante idi apothadi next daniki velakunda so next daniki velalai ante next object ni use cheyali 
                    app.use((req, res, next)=>{   // here express manaki inko object ni isthadi ade next 
                      res.send('aagu nayana')
                      next()
                    })

                    ippudu ee middleware tarvatha unna routes ni execute chestadi 

                    middleware ni configure kooda cheyochu 
                    

           ==>   COOKIES :
                ----------- 
                
                  A cookie (also known as a web cookie or browser cookie) is a small piece of data a server sends to a user's web broswer 
                  cookie anedi oka data  browser nunchi server ki request velthe  server aa data ni web broswer ki pampisthadi
                  ila server nunchi cookies ni pampiyali ante oka middleware undali  dani kosam manam install cheyali 
                  npm i cookie-parser 

                  Cookies mana localhost/url lo domain ki bind aithai nuvvu eh port aina localhost meda run aina mana cookie matram aa localhost ki bind aithai 
                  so default ga browser lo store chesukoni pettukuntadi permanent ga store chesukuntadi 

                  ippudu localhost:4500/abc ki pampithe request browser nunchi  server ki request isthe app.get('/abc',(req, res)=>{res.cookies('mass', 'naa cookie')})
                  manaki server uh response lo cookies ni browser ki isthadi browser store chesukoni pettukuntadi 
                  ade localhost:4500/pqr ane request pampisthe browser nunchi server ki request velthadi akkada app.get('/pqr', (req, res)=>{req.cookies}) 
                  ikkada manaki unna previous cookies pqr path request dwara velthadi kani adi cookies lo untadi ade req.cookies ane property loki raniki manaki oka middelware 
                  ni use chestam ade app.use(cookieParser()) idi execute ayy request object lo cookie ane property lopala cookies ani oka object laga marchi unchukuntadi

                  Cookies : Its a piece of data created by the server and will send it to a browser and there it will be stored inside the browser 
                            These cookies will be sent to the server on every subsequent request to the same host 
                            [ante eh host nunchi aithe aa cookies create ayy vachinayo aa host ki migitha eh request pampina sare cookies anevi veltha untai 
                            aa cookies ni ela handle chestam ante cookieParser middleware tho chestam ]
                            [These cookies will be forward along with request to the server on every request (prathi request ki cookies request tho paatu server ki velthadi 
                            particulary host name(eh server nunchi cookies vachayo aa url tho register ayy store aipoi untai) )]
                  
          ==>  AUTHENTICATION :  securing our routes using cookies 
                            manam normal ga routes rasinavi anni public ga access aithunai so ala kakunda only authenticate users eh access ayyela 
                            ela cheyochu so mana anni routes konni authenticate user ki access ayyela cheyali inkonni andariki access ayyela rayali anedi point 
                            daniki manam cookies dwara ela chestamo choodam : 
                            
                            user uh login login ainapudu cookies anevi generate avvali 
                            danikosam manam app.post('/login', (req, res)=>{
                                    res.cookie('username', req.body.username)
                                    res.cookie('password', req.body.password)   
                            })

                            migitha routes ani ikkada untai ... ila undatam vala easy ga public ga access chesukuntaru andaru so 
                            dani kosam manam middleware ni use chestam adi block chestadi 
                            ila rasukuntam 
                                
                            app.use((req, res, next)=>{
                                 if(req.cookie.username)
                                 {
                                      next() // next unna routes ki velochu 
                                 }
                                 else 
                                 {
                                      res.sendFile('/login.html') // ane page ki redirect avvali 
                                 }
                            })

                            ee middleware ekkada rastunam anedi kooda important eh so login route paina raste login route execute avvakundane 
                            ee middleware execute avvatam vala manaki req.cookie.username undefined vastadi undefined vaste next route ki ranivadu 
                            so ranivakapothe asal login route ke radu andhuke middleware ekkada pettalo important ekkada block cheyali ekkada block cheyakudadu ani 
                            choosi pettali mana case lo middleware paina login route ni rasukunte saripothadi first adi execute aina tarvathe middleware execute aithadi 
                            so appatiki cookies vastai kabbati undefined unadu so next() execute ayy next routes ki velthadi.


               SESSION STORAGE : 

                                session ane oka mechanism undi - as soon as manam oka website open cheyagane server em chestadi ante 
                                                                 oka unique session id ni browser ki pampisthadi 
                                                                 
                                session ni configure cheyaniki manam first manaki express-session kavali 
                                danikosam npm i express-session ni install cheyali 
                                server.js lo 
                                     var expressSession = require('express-session')
                                         app.use(expressSession({
                                          secret : 'mass ...', // secret key istham 
                                          cookie : {maxAge : 60000}
                                         }))
                                     ila configure chesukunte 
                                starting lo manam request pampisthe manaki oka cookies lo oka connect.id vastadi 
                                ade vere tab lo open chesi same server ki pampisthe request appudu inko different connect.id ni isthadi 
                                browser evi two different connections ani anukuntadi so same session id continue avvavu renditiki request same aina 
                                manaki rendu tab lu unnai present scenario lo so oka tab ki oka session id maintain aithundi inko tab ki maroka session id 
                                maintain aithundi so aa rendu tab la nunchi different different request lu velinatle gamanisthadi ippudu oka tab nunchi pani cheste 
                                okala gurtisthadi vere tab lo pani cheste verodila gurtisthadi
                                
                                Benefit of the Session : 
                                       oka tab nunchi refresh cheste appudu inkoka kotha session id create chesinatle 
                                       maxAge value session id expire kooda aithadi [session id oka expire date kooda untadi ]
                                       ah session id ni mana server uh remove chestadi
                                       mana server ki enni request lu vachayo annitiki session id create avvavu 
                                       different different  browsers / different different tabs ki different different session id's uh create aithai 
                                       ala ani oka particular tab lo manam multiple request lu pampisthe prathi request ki session id create avvavu 
                                  Note : server ni restart cheste old server meda unna old sessions anni remove aithai  

                                 mana Cookie maxAge limit 1 minute untadi. 
                                 manam session expires avvakamundu anni tabs lo run cheste same session id maintain chestadi 
                                 browser close chesi open chesina sare same session id maintain avuthadi.
                                 ila enduku ante because of maxAge

                      ee sessionId maintain chesi mana login system ni maintain chesukovocha ? 


                            session counts kooda chesukovochu 
                                    app.use((req, res, next)=>{

                                      // console.log(req.session)
                                      // console.log(req.sessionID)
                                      if(req.session.count){
                                          req.session.count++
                                      }
                                      else 
                                      {
                                          req.session.count = 1   // session ki cunt ane property ni add chestunam 
                                      }
                                      console.log(req.session)
                                      next()
                                  })

                                  app.use((req, res, next)=>{
                                
                                    if(req.session.username)
                                    {
                                        next()
                                    }
                                    else 
                                    {
                                        res.redirect('/login.html')
                                    }
                                    
                                })

                    Note : cookies lo session id untadi so req.cookie.username pamapka poina 
                           cookie lo sessionid undi so prathi request ki ee cookie travel avuthune untadi 
                           aa cookie lo unna session id ni tesukoni server uh evadu eh session idi aa session ki
                           username unda ani check chesukoni undi kabbati aa path ni isthadi ledante redirect to login
                           page.

                           server restart cheste old sessionid anni pothai so redirect lo login page 
                           mari pedda applications like gmail, linkedin emaina chinna changes jarigithe 
                           server restart aithai kani mana sessionid ni valu database lo store chesukuntaru 
                           avi update ainapudu sessions expire avvavu endhuku ante databse lo store chesinavi 
                           session ni techukoni pettukuntadi 

                           Token-based Mechanism kooda undi 

                           


                               


            </code>
        </pre>
    </body>
</html>